# Домашнее задание к занятию "6.1. Типы и структура СУБД"

## Введение

*Перед выполнением задания вы можете ознакомиться с 
[дополнительными материалами](https://github.com/netology-code/virt-homeworks/tree/master/additional/README.md).*

## Задача 1

*Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных.*

*Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:*

- *Электронные чеки в json виде*
- *Склады и автомобильные дороги для логистической компании*
- *Генеалогические деревья*
- *Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации*
- *Отношения клиент-покупка для интернет-магазина*

*Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.*

**Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных.**

Перво-наперво, объясню архитектору, что работал я только с **MySQL**, да немного с **Redis** и **ElasticSearch**, причём последние две использовались в режиме "чёрного ящика" (требовались для софта - я их поставил, запустил и больше не трогаю, пока они хоть как-то работают). Соответственно, спрашивать именно ***меня*** по БД несколько... опрометчиво.

* **Электронные чеки в json виде**  
Не уверен.  
С одной стороны, в наличии специализированные DB для json типа **MongoDB**. Нет проблем с шардингом и горизонтальным скейлингом. Поддерживается модификация отдельных полей в JSON.  
С другой стороны, приверженцы **PostgreSQL** с пеной у рта доказывают, что их вариант не хуже, а местами и быстрее.  
Впрочем, некоторые гуру в споре **MongoDB** vs **PostgreSQL** предлагают ориентироваться на наличие у вас разработчиков с опытом работы с той или иной DB. Ибо без толку полагаться на какую-то технологию, если у вас нет соответствующих спецов. И что-то в этом подходе таки есть.

* **Склады и автомобильные дороги для логистической компании**  
Если я правильно понял, речь идёт о GIS-данных?  
Если угадал, то в **MySQL/MariaDB** есть встроенная поддержка таких типов данных.  
В случае, если **MySQL** почему-то не подходит, можно воспользоваться **PostgreSQL** (там, если верить инету, придётся добавить расширение **PostGIS** для поддержки географических объектов)

* **Генеалогические деревья**  
Сдаётся мне, надо искать среди DB, ориентированных на работу с графами. Но это для меня вообще тёмный лес.

* **Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации**  
В данном случае прямо таки напрашивается **Redis**. Формат "ключ-значение", встроенная поддержка TTL, хранение данных в памяти (высокая скорость и так себе надёжность) - ну так это же всего лишь кэш.

* **Отношения клиент-покупка для интернет-магазина**  
Imho, тут скорее всего будет пачка связанных друг с другом таблиц, соответственно, что-нибудь типа **MySQL/PostgreSQL** будет оптимальным выбором (что конкретно - зависит от уже установленного софта и наличия специалистов).

## Задача 2

*Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):*

- *Данные записываются на все узлы с задержкой до часа (асинхронная запись)*
- *При сетевых сбоях, система может разделиться на 2 раздельных кластера*
- *Система может не прислать корректный ответ или сбросить соединение*

*А согласно PACELC-теореме, как бы вы классифицировали данные реализации?*

* **Данные записываются на все узлы с задержкой до часа (асинхронная запись)**  
**AP**-система (нет **consistency**)
??? - PACELC

* **При сетевых сбоях, система может разделиться на 2 раздельных кластера**  
**CA**-система (ибо **Partition Tolerance** тут явно отсутствует)
**PA/EC** - ответ есть всегда, но данные в разных частях кластера могут отличаться

* **Система может не прислать корректный ответ или сбросить соединение**  
**P**-система (нет ни **consistency**, ни **availability**)
??? - PACELC

По-моему, PACELC только ещё больше запутывает картину и угадать на какой глобус какую сову натягивать становится ещё сложнее.

## Задача 3

*Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?*

**Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?**  
По идее, не могут, ну, если только система не поддерживает два разных движка, написанных с учетом BASE и ACID-принципов соответственно.  

**BASE**: Главное - скорость ответа и доступность, приврать в данных - не возбраняется.  

**ACID**: Главное - достоверность данных, о скорости можно не мечтать, ибо сложные протоколы обработки и синхронизации данных.  

Соответственно, совместить два противоположных подхода в одной упряжке "в лоб" нереально.

## Задача 4

*Вам дали задачу написать системное решение, основой которого бы послужили:*

- *фиксация некоторых значений с временем жизни*
- *реакция на истечение таймаута*

*Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/). 
Что это за система? Какие минусы выбора данной системы?*

**Выбор БД:**
Из более-менее распространённых БД на вышеописанную роль вполне себе подойдёт **Redis**  
*(возможно, есть кандидаты и получше, но с* ***Redis*** *`ом я хотя бы в реальной жизни сталкивался, пусть и пользовался им как "чёрным ящиком" без понимания всех его глубин)*

**Минусы:**
* Все данные лежат в оперативке, на диск, если правильно помню, они тоже скидываются, но изредка. Следовательно, памяти надо много, да и с надёжностью хранения данных в случае проблем с питанием на сервере могут быть вопросы.

* И, вроде как, настройка кластера несколько нетривиальна. *(но я в такие глубины лично не залазил)*

* И, если я правильно понимаю, то нет гарантии, что подписчик гарантированно получит данные из БД (если подписчик в текущий момент чем-то занят, то, вроде как, никто ему второй раз напоминаний присылать не будет)

---

### Как cдавать задание

*Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.*

---
